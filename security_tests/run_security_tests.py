#!/usr/bin/env python3
"""
AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ - ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
ëª¨ë“  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•© ì‹¤í–‰í•˜ëŠ” ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
"""

import asyncio
import argparse
import json
import os
import sys
from datetime import datetime
from pathlib import Path

# í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¥¼ Python ê²½ë¡œì— ì¶”ê°€
project_root = Path(__file__).parent.parent
sys.path.insert(0, str(project_root))

from security_tests.python.security_test_runner import SecurityTestRunner
from security_tests.tools.vulnerability_scanner import VulnerabilityScanner

class SecurityTestOrchestrator:
    """ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°"""
    
    def __init__(self, target_url: str, api_url: str, test_mode: str = 'safe'):
        self.target_url = target_url
        self.api_url = api_url
        self.test_mode = test_mode
        self.results = {}
        
    async def run_all_security_tests(self):
        """ëª¨ë“  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰"""
        print("ğŸ”’ AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ - ì¢…í•© ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹œì‘")
        print("=" * 60)
        
        # 1. ë™ì  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ (ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜)
        print("ğŸŒ ë™ì  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...")
        await self._run_dynamic_security_tests()
        
        # 2. ì •ì  ë³´ì•ˆ ë¶„ì„ (ì½”ë“œ ë° ì„¤ì •)
        print("ğŸ” ì •ì  ë³´ì•ˆ ë¶„ì„ ì‹¤í–‰ ì¤‘...")
        await self._run_static_security_analysis()
        
        # 3. ê²°ê³¼ í†µí•© ë° ë¦¬í¬íŠ¸ ìƒì„±
        print("ğŸ“Š ê²°ê³¼ ë¶„ì„ ë° ë¦¬í¬íŠ¸ ìƒì„± ì¤‘...")
        await self._generate_comprehensive_report()
        
        print("âœ… ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")
        
    async def _run_dynamic_security_tests(self):
        """ë™ì  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰"""
        try:
            # SecurityTestRunner ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
            security_runner = SecurityTestRunner(
                target_url=self.target_url,
                api_url=self.api_url,
                test_mode=self.test_mode
            )
            
            await security_runner.setup_session()
            
            # ì¸ì¦ ë³´ì•ˆ í…ŒìŠ¤íŠ¸
            print("  ğŸ” ì¸ì¦ ë³´ì•ˆ í…ŒìŠ¤íŠ¸...")
            auth_results = await security_runner.test_authentication_security()
            
            # ì…ë ¥ ê²€ì¦ í…ŒìŠ¤íŠ¸
            print("  ğŸ“ ì…ë ¥ ê²€ì¦ í…ŒìŠ¤íŠ¸...")
            input_results = await security_runner.test_input_validation()
            
            # API ë³´ì•ˆ í…ŒìŠ¤íŠ¸
            print("  ğŸ”Œ API ë³´ì•ˆ í…ŒìŠ¤íŠ¸...")
            api_results = await security_runner.test_api_security()
            
            # ì„¸ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŠ¸
            print("  ğŸ•’ ì„¸ì…˜ ë³´ì•ˆ í…ŒìŠ¤íŠ¸...")
            session_results = await security_runner.test_session_security()
            
            # SSL/TLS ë³´ì•ˆ í…ŒìŠ¤íŠ¸
            print("  ğŸ”’ SSL/TLS ë³´ì•ˆ í…ŒìŠ¤íŠ¸...")
            ssl_results = await security_runner.test_ssl_security()
            
            await security_runner.cleanup_session()
            
            # ê²°ê³¼ ì €ì¥
            self.results['dynamic_tests'] = {\n                'authentication': [self._convert_result_to_dict(r) for r in auth_results],\n                'input_validation': [self._convert_result_to_dict(r) for r in input_results],\n                'api_security': [self._convert_result_to_dict(r) for r in api_results],\n                'session_security': [self._convert_result_to_dict(r) for r in session_results],\n                'ssl_tls': [self._convert_result_to_dict(r) for r in ssl_results]\n            }\n            \n            print(f\"  âœ… ë™ì  í…ŒìŠ¤íŠ¸ ì™„ë£Œ: {len(auth_results + input_results + api_results + session_results + ssl_results)}ê°œ ê²°ê³¼\")\n            \n        except Exception as e:\n            print(f\"  âŒ ë™ì  í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: {e}\")\n            self.results['dynamic_tests'] = {'error': str(e)}\n            \n    async def _run_static_security_analysis(self):\n        \"\"\"ì •ì  ë³´ì•ˆ ë¶„ì„ ì‹¤í–‰\"\"\"\n        try:\n            # VulnerabilityScanner ì¸ìŠ¤í„´ìŠ¤ ìƒì„±\n            scanner = VulnerabilityScanner()\n            \n            # ì·¨ì•½ì  ìŠ¤ìº” ì‹¤í–‰\n            findings = await scanner.scan_all()\n            \n            # ìŠ¤ìº” ë¦¬í¬íŠ¸ ìƒì„±\n            scan_report = scanner.generate_report()\n            \n            # ê²°ê³¼ ì €ì¥\n            self.results['static_analysis'] = scan_report\n            \n            print(f\"  âœ… ì •ì  ë¶„ì„ ì™„ë£Œ: {len(findings)}ê°œ ì·¨ì•½ì  ë°œê²¬\")\n            \n        except Exception as e:\n            print(f\"  âŒ ì •ì  ë¶„ì„ ì‹¤íŒ¨: {e}\")\n            self.results['static_analysis'] = {'error': str(e)}\n            \n    def _convert_result_to_dict(self, result):\n        \"\"\"SecurityTestResultë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜\"\"\"\n        if hasattr(result, '__dict__'):\n            result_dict = result.__dict__.copy()\n            # datetime ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜\n            if 'timestamp' in result_dict and hasattr(result_dict['timestamp'], 'isoformat'):\n                result_dict['timestamp'] = result_dict['timestamp'].isoformat()\n            return result_dict\n        return result\n        \n    async def _generate_comprehensive_report(self):\n        \"\"\"ì¢…í•© ë³´ì•ˆ ë¦¬í¬íŠ¸ ìƒì„±\"\"\"\n        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        \n        # ì „ì²´ ìš”ì•½ í†µê³„\n        summary = self._calculate_security_summary()\n        \n        # ì¢…í•© ë¦¬í¬íŠ¸ êµ¬ì¡°\n        comprehensive_report = {\n            'test_info': {\n                'timestamp': datetime.now().isoformat(),\n                'target_url': self.target_url,\n                'api_url': self.api_url,\n                'test_mode': self.test_mode\n            },\n            'summary': summary,\n            'dynamic_tests': self.results.get('dynamic_tests', {}),\n            'static_analysis': self.results.get('static_analysis', {}),\n            'recommendations': self._generate_security_recommendations(summary)\n        }\n        \n        # JSON ë¦¬í¬íŠ¸ ì €ì¥\n        json_filename = f\"comprehensive_security_report_{timestamp}.json\"\n        with open(json_filename, 'w', encoding='utf-8') as f:\n            json.dump(comprehensive_report, f, indent=2, ensure_ascii=False)\n            \n        # í…ìŠ¤íŠ¸ ë¦¬í¬íŠ¸ ìƒì„± ë° ì €ì¥\n        text_report = self._generate_text_report(comprehensive_report)\n        text_filename = f\"comprehensive_security_report_{timestamp}.txt\"\n        with open(text_filename, 'w', encoding='utf-8') as f:\n            f.write(text_report)\n            \n        # HTML ë¦¬í¬íŠ¸ ìƒì„±\n        html_report = self._generate_html_report(comprehensive_report)\n        html_filename = f\"comprehensive_security_report_{timestamp}.html\"\n        with open(html_filename, 'w', encoding='utf-8') as f:\n            f.write(html_report)\n            \n        print(f\"\\nğŸ“„ ë³´ê³ ì„œ íŒŒì¼:\")\n        print(f\"   JSON: {json_filename}\")\n        print(f\"   Text: {text_filename}\")\n        print(f\"   HTML: {html_filename}\")\n        \n    def _calculate_security_summary(self):\n        \"\"\"ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìš”ì•½ í†µê³„ ê³„ì‚°\"\"\"\n        summary = {\n            'total_issues': 0,\n            'critical_issues': 0,\n            'high_issues': 0,\n            'medium_issues': 0,\n            'low_issues': 0,\n            'info_issues': 0,\n            'dynamic_test_results': 0,\n            'static_analysis_findings': 0,\n            'overall_security_score': 0\n        }\n        \n        # ë™ì  í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„\n        dynamic_tests = self.results.get('dynamic_tests', {})\n        for test_category, results in dynamic_tests.items():\n            if isinstance(results, list):\n                summary['dynamic_test_results'] += len(results)\n                for result in results:\n                    if isinstance(result, dict) and 'severity' in result:\n                        severity = result['severity']\n                        summary[f'{severity}_issues'] = summary.get(f'{severity}_issues', 0) + 1\n                        summary['total_issues'] += 1\n                        \n        # ì •ì  ë¶„ì„ ê²°ê³¼ ë¶„ì„\n        static_analysis = self.results.get('static_analysis', {})\n        if 'findings' in static_analysis:\n            findings = static_analysis['findings']\n            summary['static_analysis_findings'] = len(findings)\n            \n            for finding in findings:\n                severity = finding.get('severity', 'info')\n                summary[f'{severity}_issues'] = summary.get(f'{severity}_issues', 0) + 1\n                summary['total_issues'] += 1\n                \n        # ë³´ì•ˆ ì ìˆ˜ ê³„ì‚° (100ì  ë§Œì )\n        critical_weight = summary['critical_issues'] * 20\n        high_weight = summary['high_issues'] * 10\n        medium_weight = summary['medium_issues'] * 5\n        low_weight = summary['low_issues'] * 2\n        \n        total_penalty = critical_weight + high_weight + medium_weight + low_weight\n        summary['overall_security_score'] = max(0, 100 - total_penalty)\n        \n        return summary\n        \n    def _generate_security_recommendations(self, summary):\n        \"\"\"ë³´ì•ˆ ê°œì„  ê¶Œì¥ì‚¬í•­ ìƒì„±\"\"\"\n        recommendations = []\n        \n        if summary['critical_issues'] > 0:\n            recommendations.append({\n                'priority': 'critical',\n                'title': 'ì¦‰ì‹œ ìˆ˜ì • í•„ìš”í•œ ì¹˜ëª…ì  ë³´ì•ˆ ì·¨ì•½ì ',\n                'description': f\"{summary['critical_issues']}ê°œì˜ ì¹˜ëª…ì  ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.\",\n                'action': 'ê°œë°œíŒ€ì— ì¦‰ì‹œ ì•Œë¦¬ê³  ê¸´ê¸‰ íŒ¨ì¹˜ë¥¼ ì ìš©í•˜ì„¸ìš”.'\n            })\n            \n        if summary['high_issues'] > 0:\n            recommendations.append({\n                'priority': 'high',\n                'title': 'ë†’ì€ ìœ„í—˜ë„ ë³´ì•ˆ ì·¨ì•½ì ',\n                'description': f\"{summary['high_issues']}ê°œì˜ ë†’ì€ ìœ„í—˜ë„ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.\",\n                'action': 'ê°€ëŠ¥í•œ ë¹¨ë¦¬ ìˆ˜ì •í•˜ê³  ë³´ì•ˆ íŒ¨ì¹˜ë¥¼ ì ìš©í•˜ì„¸ìš”.'\n            })\n            \n        if summary['overall_security_score'] < 70:\n            recommendations.append({\n                'priority': 'medium',\n                'title': 'ì „ë°˜ì ì¸ ë³´ì•ˆ ê°•í™” í•„ìš”',\n                'description': f\"í˜„ì¬ ë³´ì•ˆ ì ìˆ˜: {summary['overall_security_score']}/100\",\n                'action': 'ë³´ì•ˆ ì •ì±…ì„ ê²€í† í•˜ê³  í¬ê´„ì ì¸ ë³´ì•ˆ ê°•í™” ê³„íšì„ ìˆ˜ë¦½í•˜ì„¸ìš”.'\n            })\n            \n        if summary['medium_issues'] > 5:\n            recommendations.append({\n                'priority': 'medium',\n                'title': 'ì¤‘ê°„ ìœ„í—˜ë„ ì·¨ì•½ì  ë‹¤ìˆ˜ ë°œê²¬',\n                'description': f\"{summary['medium_issues']}ê°œì˜ ì¤‘ê°„ ìœ„í—˜ë„ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.\",\n                'action': 'ì •ê¸°ì ì¸ ë³´ì•ˆ ì ê²€ê³¼ ì½”ë“œ ë¦¬ë·°ë¥¼ ê°•í™”í•˜ì„¸ìš”.'\n            })\n            \n        # ê¸°ë³¸ ê¶Œì¥ì‚¬í•­\n        recommendations.extend([\n            {\n                'priority': 'general',\n                'title': 'ì •ê¸°ì ì¸ ë³´ì•ˆ í…ŒìŠ¤íŠ¸',\n                'description': 'ë³´ì•ˆ ì·¨ì•½ì ì€ ì§€ì†ì ìœ¼ë¡œ ë°œê²¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',\n                'action': 'ì›” 1íšŒ ì´ìƒ ì •ê¸°ì ì¸ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤ì‹œí•˜ì„¸ìš”.'\n            },\n            {\n                'priority': 'general',\n                'title': 'ë³´ì•ˆ êµìœ¡ ë° ì¸ì‹ ì œê³ ',\n                'description': 'ê°œë°œíŒ€ì˜ ë³´ì•ˆ ì¸ì‹ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.',\n                'action': 'ì •ê¸°ì ì¸ ë³´ì•ˆ êµìœ¡ê³¼ ë³´ì•ˆ ì½”ë”© ê°€ì´ë“œë¼ì¸ì„ ì œê³µí•˜ì„¸ìš”.'\n            }\n        ])\n        \n        return recommendations\n        \n    def _generate_text_report(self, report):\n        \"\"\"í…ìŠ¤íŠ¸ í˜•íƒœì˜ ë³´ì•ˆ ë¦¬í¬íŠ¸ ìƒì„±\"\"\"\n        lines = []\n        lines.append(\"=\" * 70)\n        lines.append(\"AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ - ì¢…í•© ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸\")\n        lines.append(\"=\" * 70)\n        \n        # í…ŒìŠ¤íŠ¸ ì •ë³´\n        test_info = report['test_info']\n        lines.append(f\"í…ŒìŠ¤íŠ¸ ì‹œê°„: {test_info['timestamp']}\")\n        lines.append(f\"ëŒ€ìƒ URL: {test_info['target_url']}\")\n        lines.append(f\"API URL: {test_info['api_url']}\")\n        lines.append(f\"í…ŒìŠ¤íŠ¸ ëª¨ë“œ: {test_info['test_mode']}\")\n        lines.append(\"\")\n        \n        # ìš”ì•½\n        summary = report['summary']\n        lines.append(\"ğŸ“Š ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìš”ì•½\")\n        lines.append(\"-\" * 40)\n        lines.append(f\"ì „ì²´ ë³´ì•ˆ ì ìˆ˜: {summary['overall_security_score']}/100\")\n        lines.append(f\"ì´ ë°œê²¬ëœ ë¬¸ì œ: {summary['total_issues']}ê°œ\")\n        lines.append(f\"  - ì¹˜ëª…ì : {summary['critical_issues']}ê°œ\")\n        lines.append(f\"  - ë†’ìŒ: {summary['high_issues']}ê°œ\")\n        lines.append(f\"  - ë³´í†µ: {summary['medium_issues']}ê°œ\")\n        lines.append(f\"  - ë‚®ìŒ: {summary['low_issues']}ê°œ\")\n        lines.append(f\"  - ì •ë³´: {summary['info_issues']}ê°œ\")\n        lines.append(\"\")\n        \n        # ë™ì  í…ŒìŠ¤íŠ¸ ê²°ê³¼\n        lines.append(\"ğŸŒ ë™ì  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ê²°ê³¼\")\n        lines.append(\"-\" * 40)\n        dynamic_tests = report.get('dynamic_tests', {})\n        for category, results in dynamic_tests.items():\n            if isinstance(results, list):\n                lines.append(f\"  {category}: {len(results)}ê°œ ê²°ê³¼\")\n                # ì‹¬ê°í•œ ë¬¸ì œë§Œ í‘œì‹œ\n                for result in results:\n                    if isinstance(result, dict) and result.get('severity') in ['critical', 'high']:\n                        lines.append(f\"    - {result.get('test_name', 'Unknown')}: {result.get('severity', 'Unknown')}\")\n        lines.append(\"\")\n        \n        # ì •ì  ë¶„ì„ ê²°ê³¼\n        lines.append(\"ğŸ” ì •ì  ë³´ì•ˆ ë¶„ì„ ê²°ê³¼\")\n        lines.append(\"-\" * 40)\n        static_analysis = report.get('static_analysis', {})\n        if 'findings' in static_analysis:\n            findings = static_analysis['findings']\n            lines.append(f\"ì´ {len(findings)}ê°œ ì·¨ì•½ì  ë°œê²¬\")\n            \n            # ì‹¬ê°ë„ë³„ ìƒìœ„ 5ê°œì”© í‘œì‹œ\n            for severity in ['critical', 'high', 'medium']:\n                severity_findings = [f for f in findings if f.get('severity') == severity]\n                if severity_findings:\n                    lines.append(f\"\\n  {severity.upper()} ë“±ê¸‰:\")\n                    for finding in severity_findings[:5]:\n                        lines.append(f\"    - {finding.get('title', 'Unknown')} ({finding.get('location', 'Unknown')})\")\n                    if len(severity_findings) > 5:\n                        lines.append(f\"    ... ë° {len(severity_findings) - 5}ê°œ ë”\")\n        lines.append(\"\")\n        \n        # ê¶Œì¥ì‚¬í•­\n        lines.append(\"ğŸ’¡ ë³´ì•ˆ ê°œì„  ê¶Œì¥ì‚¬í•­\")\n        lines.append(\"-\" * 40)\n        recommendations = report.get('recommendations', [])\n        for i, rec in enumerate(recommendations, 1):\n            lines.append(f\"{i}. [{rec['priority'].upper()}] {rec['title']}\")\n            lines.append(f\"   {rec['description']}\")\n            lines.append(f\"   ì¡°ì¹˜: {rec['action']}\")\n            lines.append(\"\")\n            \n        return \"\\n\".join(lines)\n        \n    def _generate_html_report(self, report):\n        \"\"\"HTML í˜•íƒœì˜ ë³´ì•ˆ ë¦¬í¬íŠ¸ ìƒì„±\"\"\"\n        summary = report['summary']\n        \n        # ë³´ì•ˆ ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ ê²°ì •\n        score = summary['overall_security_score']\n        if score >= 80:\n            score_color = \"#28a745\"  # ë…¹ìƒ‰\n        elif score >= 60:\n            score_color = \"#ffc107\"  # ë…¸ë€ìƒ‰\n        else:\n            score_color = \"#dc3545\"  # ë¹¨ê°„ìƒ‰\n            \n        html = f\"\"\"\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ - ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸</title>\n    <style>\n        body {{ font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }}\n        .container {{ max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }}\n        .header {{ text-align: center; margin-bottom: 30px; }}\n        .score {{ font-size: 48px; font-weight: bold; color: {score_color}; }}\n        .summary {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }}\n        .summary-card {{ background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; }}\n        .severity-critical {{ background: #dc3545; color: white; }}\n        .severity-high {{ background: #fd7e14; color: white; }}\n        .severity-medium {{ background: #ffc107; color: black; }}\n        .severity-low {{ background: #20c997; color: white; }}\n        .section {{ margin: 30px 0; }}\n        .section h2 {{ border-bottom: 2px solid #007bff; padding-bottom: 10px; }}\n        .finding {{ background: #f8f9fa; border-left: 4px solid #007bff; padding: 15px; margin: 10px 0; }}\n        .finding.critical {{ border-left-color: #dc3545; }}\n        .finding.high {{ border-left-color: #fd7e14; }}\n        .finding.medium {{ border-left-color: #ffc107; }}\n        .recommendation {{ background: #e7f3ff; border: 1px solid #b3d9ff; padding: 15px; margin: 10px 0; border-radius: 5px; }}\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ”’ AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸</h1>\n            <p>í…ŒìŠ¤íŠ¸ ì‹œê°„: {report['test_info']['timestamp']}</p>\n            <div class=\"score\">{score}/100</div>\n            <p>ì „ì²´ ë³´ì•ˆ ì ìˆ˜</p>\n        </div>\n        \n        <div class=\"summary\">\n            <div class=\"summary-card severity-critical\">\n                <h3>ì¹˜ëª…ì </h3>\n                <div style=\"font-size: 24px;\">{summary['critical_issues']}</div>\n            </div>\n            <div class=\"summary-card severity-high\">\n                <h3>ë†’ìŒ</h3>\n                <div style=\"font-size: 24px;\">{summary['high_issues']}</div>\n            </div>\n            <div class=\"summary-card severity-medium\">\n                <h3>ë³´í†µ</h3>\n                <div style=\"font-size: 24px;\">{summary['medium_issues']}</div>\n            </div>\n            <div class=\"summary-card severity-low\">\n                <h3>ë‚®ìŒ</h3>\n                <div style=\"font-size: 24px;\">{summary['low_issues']}</div>\n            </div>\n        </div>\n        \n        <div class=\"section\">\n            <h2>ğŸ¯ ì£¼ìš” ë°œê²¬ì‚¬í•­</h2>\n        \"\"\"\n        \n        # ì •ì  ë¶„ì„ ê²°ê³¼ì˜ ì£¼ìš” ë°œê²¬ì‚¬í•­ ì¶”ê°€\n        static_analysis = report.get('static_analysis', {})\n        if 'findings' in static_analysis:\n            findings = static_analysis['findings']\n            high_priority_findings = [f for f in findings if f.get('severity') in ['critical', 'high']]\n            \n            for finding in high_priority_findings[:10]:  # ìƒìœ„ 10ê°œë§Œ í‘œì‹œ\n                severity = finding.get('severity', 'info')\n                html += f\"\"\"\n            <div class=\"finding {severity}\">\n                <h4>{finding.get('title', 'Unknown Issue')}</h4>\n                <p><strong>ìœ„ì¹˜:</strong> {finding.get('location', 'Unknown')}</p>\n                <p><strong>ì„¤ëª…:</strong> {finding.get('description', 'No description')}</p>\n                <p><strong>ê¶Œì¥ ì¡°ì¹˜:</strong> {finding.get('remediation', 'No remediation provided')}</p>\n            </div>\n                \"\"\"\n                \n        html += \"\"\"\n        </div>\n        \n        <div class=\"section\">\n            <h2>ğŸ’¡ ê¶Œì¥ì‚¬í•­</h2>\n        \"\"\"\n        \n        # ê¶Œì¥ì‚¬í•­ ì¶”ê°€\n        recommendations = report.get('recommendations', [])\n        for rec in recommendations:\n            html += f\"\"\"\n            <div class=\"recommendation\">\n                <h4>[{rec['priority'].upper()}] {rec['title']}</h4>\n                <p>{rec['description']}</p>\n                <p><strong>ì¡°ì¹˜:</strong> {rec['action']}</p>\n            </div>\n            \"\"\"\n            \n        html += \"\"\"\n        </div>\n        \n        <div class=\"section\">\n            <p><small>ì´ ë¦¬í¬íŠ¸ëŠ” AI ëª¨ë¸ ê´€ë¦¬ ì‹œìŠ¤í…œ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ë„êµ¬ì— ì˜í•´ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</small></p>\n        </div>\n    </div>\n</body>\n</html>\n        \"\"\"\n        \n        return html\n\nasync def main():\n    \"\"\"ë©”ì¸ í•¨ìˆ˜\"\"\"\n    parser = argparse.ArgumentParser(description='AI Model Management Security Test Suite')\n    parser.add_argument('--target-url', default='http://localhost:3000', \n                       help='Frontend target URL')\n    parser.add_argument('--api-url', default='http://localhost:8000',\n                       help='Backend API URL')\n    parser.add_argument('--test-mode', choices=['safe', 'aggressive'], default='safe',\n                       help='Test mode (safe: ê¸°ë³¸ í…ŒìŠ¤íŠ¸, aggressive: ê°•í™” í…ŒìŠ¤íŠ¸)')\n    \n    args = parser.parse_args()\n    \n    # ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ìƒì„± ë° ì‹¤í–‰\n    orchestrator = SecurityTestOrchestrator(\n        target_url=args.target_url,\n        api_url=args.api_url,\n        test_mode=args.test_mode\n    )\n    \n    await orchestrator.run_all_security_tests()\n    \nif __name__ == \"__main__\":\n    asyncio.run(main())