[2025-06-27 09:35:00] 🚀 AI 모델 관리 시스템 - 스테이징 환경 배포
[2025-06-27 09:35:00] ℹ️ 배포 환경: staging
[2025-06-27 09:35:00] ℹ️ 프로젝트: ai-model-mgmt
[2025-06-27 09:35:00] ℹ️ ECR 레지스트리: 123456789012.dkr.ecr.ap-northeast-2.amazonaws.com
[2025-06-27 09:35:00] ℹ️ 이미지 태그: staging-20250627-093500

⚙️ 사전 요구사항 검사
==============================================================
[2025-06-27 09:35:02] ✅ docker 명령어 확인됨
[2025-06-27 09:35:02] ✅ docker-compose 명령어 확인됨
[2025-06-27 09:35:02] ✅ aws 명령어 확인됨
[2025-06-27 09:35:02] ✅ curl 명령어 확인됨
[2025-06-27 09:35:02] ✅ jq 명령어 확인됨
[2025-06-27 09:35:03] ✅ AWS 인증 확인됨
[2025-06-27 09:35:04] ✅ 디스크 공간 확인됨 (15GB 사용가능)
[2025-06-27 09:35:05] ✅ 네트워크 연결 확인됨

⚙️ 현재 상태 백업
==============================================================
[2025-06-27 09:35:06] ✅ Docker Compose 설정 백업됨
[2025-06-27 09:35:06] ✅ 환경 변수 백업됨
[2025-06-27 09:35:07] ✅ 컨테이너 상태 백업됨
[2025-06-27 09:35:07] ✅ 업로드 파일 링크 생성됨
[2025-06-27 09:35:07] ✅ 백업 생성 완료: /app/backups/backup_20250627_093507

⚙️ 이미지 준비
==============================================================
[2025-06-27 09:35:08] ℹ️ ECR에 로그인 중...
[2025-06-27 09:35:10] ✅ ECR 로그인 성공
[2025-06-27 09:35:10] ℹ️ 백엔드 이미지 빌드 중...
[2025-06-27 09:35:30] ✅ 이미지 빌드 완료
[2025-06-27 09:35:30] ℹ️ 이미지를 ECR에 푸시 중...
[2025-06-27 09:37:15] ✅ 이미지 푸시 완료
[2025-06-27 09:37:45] ✅ 이미지 보안 스캔 통과 (Critical: 0, High: 2)

⚙️ 환경 설정 구성
==============================================================
[2025-06-27 09:37:46] ✅ 환경 변수 파일 생성됨
[2025-06-27 09:37:47] ✅ 디렉터리 구조 생성됨

📊 모니터링 설정
==============================================================
[2025-06-27 09:37:48] ✅ 모니터링 및 Nginx 설정 완료

🚀 서비스 배포
==============================================================
[2025-06-27 09:37:49] ℹ️ 기존 서비스 그레이스풀 중지 중...
[2025-06-27 09:38:19] ✅ 기존 서비스 중지됨
[2025-06-27 09:38:20] ℹ️ 오래된 Docker 이미지 정리 중...
[2025-06-27 09:38:35] ℹ️ 새 서비스 시작 중...
[2025-06-27 09:39:20] ✅ 서비스 배포 완료

🛡️ 배포 검증
==============================================================
[2025-06-27 09:39:21] ℹ️ 헬스체크 시도 1/30
[2025-06-27 09:39:41] ⚠️ 백엔드 서비스 포트 8000 대기 중...
[2025-06-27 09:40:01] ⚠️ 백엔드 서비스 포트 8001 대기 중...
[2025-06-27 09:40:21] ⚠️ 백엔드 서비스 포트 8002 대기 중...
[2025-06-27 09:40:41] ℹ️ 헬스체크 시도 2/30
[2025-06-27 09:41:01] ✅ 백엔드 서비스 포트 8000 정상
[2025-06-27 09:41:01] ✅ 백엔드 서비스 포트 8001 정상
[2025-06-27 09:41:01] ⚠️ 백엔드 서비스 포트 8002 대기 중...
[2025-06-27 09:41:21] ℹ️ 헬스체크 시도 3/30
[2025-06-27 09:41:21] ✅ 백엔드 서비스 포트 8000 정상
[2025-06-27 09:41:21] ✅ 백엔드 서비스 포트 8001 정상
[2025-06-27 09:41:21] ✅ 백엔드 서비스 포트 8002 정상
[2025-06-27 09:41:21] ✅ 모든 서비스가 정상 동작 중

[2025-06-27 09:41:22] ℹ️ API 기능 테스트 실행 중...
[2025-06-27 09:41:22] ✅ API 엔드포인트 /health 정상
[2025-06-27 09:41:23] ✅ API 엔드포인트 /api/health 정상
[2025-06-27 09:41:24] ⚠️ API 엔드포인트 /api/models 접근 불가 (정상일 수 있음)
[2025-06-27 09:41:25] ⚠️ API 엔드포인트 /api/users 접근 불가 (정상일 수 있음)

[2025-06-27 09:41:26] ℹ️ 성능 테스트 실행 중...
[2025-06-27 09:41:27] ✅ 응답시간 테스트 통과 (285ms)

[2025-06-27 09:41:28] ℹ️ 서비스 로그 확인 중...
[2025-06-27 09:41:30] ✅ 서비스 로그 정상
[2025-06-27 09:41:30] ✅ 배포 검증 완료

📊 모니터링 시스템 검증
==============================================================
[2025-06-27 09:41:31] ℹ️ Prometheus 대기 중... (시도 1/10)
[2025-06-27 09:41:46] ℹ️ Prometheus 대기 중... (시도 2/10)
[2025-06-27 09:42:01] ✅ Prometheus 정상 동작
[2025-06-27 09:42:02] ℹ️ Grafana 대기 중... (시도 1/10)
[2025-06-27 09:42:17] ℹ️ Grafana 대기 중... (시도 2/10)
[2025-06-27 09:42:32] ✅ Grafana 정상 동작
[2025-06-27 09:43:02] ✅ 메트릭 수집 정상 (4 개 타겟)
[2025-06-27 09:43:02] ✅ 모니터링 시스템 검증 완료

⚙️ 배포 후 정리
==============================================================
[2025-06-27 09:43:03] ℹ️ 오래된 Docker 이미지 정리 중...
[2025-06-27 09:43:15] ℹ️ 오래된 백업 정리 중...
[2025-06-27 09:43:16] ℹ️ 오래된 로그 정리 중...
[2025-06-27 09:43:17] ℹ️ 시스템 리소스 현황:
CPU: 45.2% 사용중
메모리: 67.8% 사용중
디스크: 35% 사용중
Docker 이미지: 8개
실행 중인 컨테이너: 7개
[2025-06-27 09:43:18] ✅ 배포 후 정리 완료

📊 배포 리포트 생성
==============================================================
[2025-06-27 09:43:19] ✅ 배포 리포트 생성됨: /tmp/deployment_report_20250627_094319.json

🚀 배포 완료 요약
==============================================================
✅ 스테이징 환경 배포 성공!

🎯 배포 정보:
  환경: staging
  이미지: 123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/ai-model-mgmt/backend:staging-20250627-093500
  서비스: 3개 백엔드 + 1개 워커

🔗 접속 정보:
  API: http://localhost:8000
  Prometheus: http://localhost:9090
  Grafana: http://localhost:3000 (admin/admin)

📊 시스템 상태:
  CPU: 45.2%
  메모리: 67.8%
  디스크: 35%

📋 다음 단계:
  1. 기능 테스트 실행
  2. 성능 테스트 실행
  3. 보안 테스트 실행
  4. 프로덕션 배포 승인

[2025-06-27 09:43:20] ✅ 🎉 스테이징 환경 배포가 성공적으로 완료되었습니다!